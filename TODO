-   add 3d functionality
-   add function comments
-   add further robustness to code (cassert)