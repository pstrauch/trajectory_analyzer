-   add 3d functionality
-   add robustness to code (cassert)